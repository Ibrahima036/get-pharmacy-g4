{% extends 'base.html.twig' %}

{% block title %}Dashboard{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
    <style>
        .dashboard-header {
            color: #333;
            padding-bottom: 10px;
            border-bottom: 1px solid #e0e0e0;
        }

        .stat-card {
            border: none; 
            border-radius: 10px; 
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); 
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            background-color: #fff;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }
        .stat-card .card-body {
            display: flex;
            align-items: center; 
            padding: 1.5rem; 
        }
        .stat-card .icon-circle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            font-size: 1.8rem; 
        }
        .stat-card .icon-circle.bg-primary-light { background-color: rgba(0, 123, 255, 0.1); color: #007bff; }
        .stat-card .icon-circle.bg-success-light { background-color: rgba(40, 167, 69, 0.1); color: #28a745; }
        .stat-card .icon-circle.bg-warning-light { background-color: rgba(255, 193, 7, 0.1); color: #ffc107; }
        .stat-card .icon-circle.bg-info-light { background-color: rgba(23, 162, 184, 0.1); color: #17a2b8; }
        .stat-card .icon-circle.bg-danger-light { background-color: rgba(220, 53, 69, 0.1); color: #dc3545; }

        .stat-card .stat-content h5 {
            font-size: 0.9rem;
            color: #6c757d;
            margin-bottom: 0.25rem;
            font-weight: 500;
        }
        .stat-card .stat-content .display-4 {
            font-size: 1.8rem; 
            font-weight: 600; 
            color: #343a40;
            margin-bottom: 0;
        }

        .chart-card {
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            background-color: #fff;
            padding: 1.5rem;
        }
        .chart-card .card-header {
            background-color: transparent;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 0.75rem;
            margin-bottom: 1rem;
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
        }
    </style>
{% endblock %}
{% block body %}
  <div class="container-fluid py-4 px-md-5">
        <header class="mb-4 dashboard-header">
            <h1 class="h2">Tableau de Bord </h1>
        </header>

        <div class="row mb-4">
            <div class="col-xl col-lg-4 col-md-6 mb-4">
                <div class="card stat-card h-100">
                    <div class="card-body">
                        <div class="icon-circle bg-primary-light">
                            <i class="bi bi-box-seam"></i>
                        </div>
                        <div class="stat-content">
                            <h5>Total Produits</h5>
                            <p class="display-4">{{ products|length }}</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl col-lg-4 col-md-6 mb-4">
                <div class="card stat-card h-100">
                    <div class="card-body">
                        <div class="icon-circle bg-success-light">
                            <i class="bi bi-people-fill"></i>
                        </div>
                        <div class="stat-content">
                            <h5>Total Clients</h5>
                            <p class="display-4">{{ customers|length }}</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl col-lg-4 col-md-6 mb-4">
                <div class="card stat-card h-100">
                    <div class="card-body">
                        <div class="icon-circle bg-warning-light">
                            <i class="bi bi-cart-check-fill"></i>
                        </div>
                        <div class="stat-content">
                            <h5>Total Ventes</h5>
                            <p class="display-4">{{ sales|length }}</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl col-lg-4 col-md-6 mb-4">
                <div class="card stat-card h-100">
                    <div class="card-body">
                        <div class="icon-circle bg-info-light">
                            <i class="bi bi-truck"></i>
                        </div>
                        <div class="stat-content">
                            <h5>Total Fournisseurs</h5>
                            <p class="display-4">{{ suppliers|length }}</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl col-lg-4 col-md-6 mb-4">
                <div class="card stat-card h-100">
                    <div class="card-body">
                        <div class="icon-circle bg-danger-light">
                            <i class="bi bi-person-badge-fill"></i>
                        </div>
                        <div class="stat-content">
                            <h5>Total Utilisateurs</h5>
                            <p class="display-4">{{ users|length }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="card">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h5 class="card-title fw-semibold mb-4">Liste des 5 dernières ventes</h5>
                    </div>
                    <div class="table-responsive" data-simplebar>
                        <table class="table text-nowrap align-middle table-custom mb-0">
                            <thead>
                            <tr>
                                <th scope="col" class="text-dark fw-normal">Nbr Produit</th>
                                <th scope="col" class="text-dark fw-normal">Statut</th>
                                <th scope="col" class="text-dark fw-normal">Création</th>
                                <th scope="col" class="text-dark fw-normal">Vendeur</th>
                                <th scope="col" class="text-dark fw-normal">Actions</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for sale in sales|slice(0,5) %}
                                <tr>
                                    <td><span class="text-dark">{{ sale.saleDetails | length }}</span></td>
                                    <td>{{ include('/sale/_status.html.twig') }}</td>
                                    <td>
                                        <span class="text-dark">{{ sale.createdAt ? sale.createdAt|date('d/m/y') : '' }}</span>
                                    </td>
                                    <td><span class="text-dark">{{ sale.user.username }}</span></td>
                                    <td>
                                        <a href="{{ path('app_sale_show', {'id': sale.id}) }}"
                                           class="btn btn-light"> <i class="bi bi-eye"></i></a>
                                    </td>
                                </tr>
                            {% else %}
                                <tr>
                                    <td colspan="5">Pas de ventes</td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
